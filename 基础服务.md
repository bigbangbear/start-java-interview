> 背景：FastJson 升级发现没有文档详细记录七鱼下所部署的服务，该文档文档整理实际部署的服务。同时针对服务流量，标识后续可以进行优化的服务器资源。


### 基础服务

|      | 服务名称        | 等级 | 实例数量 | 优化 |
| ---- | --------------- | ---- | -------- | ---- |
|      | cs-chat-compose | L1   | 12       | 高   |
|      |                 |      |          |      |
|      |                 |      |          |      |
|      |                 |      |          |      |
|      |                 |      |          |      |
|      |                 | L3   | 2        |      |
|      |                 | L3   | 3        |      |

### 微服务

| 服务名称                  | 等级 | 实例数量 | 优化 |
| ------------------------- | ---- | -------- | ---- |
| cs-microservice-dpu       | L3   | 3        |      |
| cs-microservice-inspector | L3   | 4        | 高   |
|                           |      |          |      |
| cs-microservice-roo       | L3   | 3        |      |
|                           |      |          |      |
|                           |      |          |      |

### 呼叫

| 服务名称        | 等级 | 实例数量 | 优化 |
| --------------- | ---- | -------- | ---- |
| cs-cc-account   | L2   | 2        |      |
| cs-cc-esls      | L2   | 2        |      |
| cs-cc-ipccagent | L2   | 3        |      |
| cs-cc-loops     | L3   | 2        |      |
| cs-cc-ocs-core  | L3   | 2        |      |
| cs-cc-tactics   | L2   | 2        |      |
| cs-cc-ipcc      | L2   | 2        |      |
| cs-cc-gateway   | L3   | 3        |      |
| cs-cc-goomei    | L3   | 2        |      |
| cs-cc-ipccapi   | L2   | 3        |      |


### 机器人

| 服务名称       | 等级 | 实例数量 | 优化       |
| -------------- | ---- | -------- | ---------- |
| cs-ai-kfbot    | L2   | 3        |            |
| cs-ai-einstein | L1   | 3        | 高         |
| cs-ai-hubble   | L3   | 3        | 高[下线中] |
| cs-ai-robot    | L3   | 3        |            |
| cs-ai-broxy    | L3   | 4        | 高[下线中] |
| cs-ai-gateway  | L3   | 3        |            |
| cs-ai-training | L3   | 3        | 高[下线]   |

### 管理后台

|                       |      |      |      |
| --------------------- | ---- | ---- | ---- |
|                       |      |      |      |
| cs-webapps-operation  | L3   | 2    | 低   |
|                       |      |      |      |
| cs-webapps-platform   | L3   | 3    | 高   |
| cs-webapps-supervisor | L3   | 3    | 高   |
|                       |      |      |      |
| cs-webapps-unicorn    | L1   | 5    | 高   |
|                       |      |      |      |
|                       |      |      |      |
|                       |      |      |      |
|                       |      |      |      |

## 待移除的服务

### 下线步骤：

0. 服务停止服务
    1. 根据 APM/Caser 判断服务是否还在使用
    2. consul 设置为维护
    
        * tomcat: /home/tomcats/cs-ai-broxy/script/consul.sh pause
        * spring: springboot_consul cs-ai-broxy pause
    3. 查看是否维护 my_service_node -n cs-ai-broxy

1. 提webapp配置工单，我们这边来下线服务实例
   1. 未使用的服务，申请下线服务实例
   2. 七鱼独立部署改造后，未使用的服务，已经申请下线服务实例，现在申请CMDB下线服务
2. DBA权限、应用白名单确认
3. CMDB服务下线工单

### 服务下线

| 服务                       | 线上实例数量                                                 | 测试实例梳理                                                 | CMDB 下线                                                    | 处理时间   | 完成时间   |
| -------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ---------- | ---------- |
| cs-webapps-bigscreen       | 0                                                            | 1[工单](http://yx.mail.netease.com/ape/#/detail/bpm?flowId=52919535&from=created) | 2020.06.04                                                   | 2020.06.02 | 2020.06.04 |
| cs-webapps-crm             | 1[工单](http://yx.mail.netease.com/ape/#/detail/bpm?flowId=52922606&from=created) | 1[工单](http://yx.mail.netease.com/ape/#/detail/bpm?flowId=52922794&from=created) |                                                              | 2020.06.02 |            |
| cs-webapps-grayapi         | 0[工单]()                                                    | 1[工单](http://yx.mail.netease.com/ape/#/list/created?from=created) | 2020.06.04                                                   | 2020.06.02 | 2020.06.04 |
| cs-webapps-mainsite        | 2[工单](http://yx.mail.netease.com/ape/#/detail/bpm?flowId=52922322&from=created) | 1[工单](http://yx.mail.netease.com/ape/#/detail/bpm?flowId=52922397&from=created) | 2020.06.04                                                   | 2020.06.02 | 2020.06.04 |
| cs-webapps-tracker         |                                                              |                                                              |                                                              |            |            |
| cs-webapps-watcher         |                                                              |                                                              |                                                              |            |            |
| cs-ai-broxy                |                                                              |                                                              |                                                              |            |            |
| cs-microservice-calculator |                                                              |                                                              |                                                              |            |            |
| cs-microservice-dac        |                                                              |                                                              |                                                              |            |            |
| cs-microservice-digger     |                                                              |                                                              |                                                              |            |            |
| cs-microservice-foundation |                                                              |                                                              |                                                              |            |            |
| cs-microservice-goojie     |                                                              |                                                              |                                                              |            |            |
| cs-microservice-incubator  |                                                              |                                                              |                                                              |            |            |
| cs-microservice-khala      |                                                              |                                                              |                                                              |            |            |
| cs-microservice-mqsapi     |                                                              |                                                              |                                                              |            |            |
| cs-microservice-notice     |                                                              |                                                              |                                                              |            |            |
| cs-microservice-notifier   |                                                              |                                                              |                                                              |            |            |
| cs-microservice-push       |                                                              |                                                              |                                                              |            |            |
| cs-microservice-rps        |                                                              |                                                              |                                                              |            |            |
| cs-microservice-screendata |                                                              |                                                              |                                                              |            |            |
| cs-microservice-skyeye     |                                                              |                                                              |                                                              |            |            |
| cs-microservice-slms       |                                                              |                                                              |                                                              |            |            |
| cs-microservice-tenant     |                                                              |                                                              |                                                              |            |            |
| cs-microservice-worksheet  |                                                              |                                                              | > 背景：FastJson 升级发现没有文档详细记录七鱼下所部署的服务，该文档文档整理实际部署的服务。同时针对服务流量，标识后续可以进行优化的服务器资源。 |            |            |
| cs-microservice-wxopen     |                                                              |                                                              | ### 基础服务                                                 |            |            |
| cs-servers-link            | 待操作                                                       |                                                              | 服务名称                                                     | 等级       | 实例数量   |
| cs-servers-loops           |                                                              |                                                              | cs-chat-compose                                              | L1         | 12         |
| cs-servers-mqs-kafka       |                                                              |                                                              | cs-data-compose                                              | L3         | 3          |
| cs-servers-mqs-rabbit      |                                                              |                                                              | cs-message-gateway                                           | L1         | 9          |
| cs-servers-mri             |                                                              |                                                              | cs-yureka                                                    | L1         | 3          |
|                            |                                                              |                                                              | cs-yuul                                                      | L1         | 3          |
| cs-servers-mri2-worker     |                                                              |                                                              | cs-gateway-opendata                                          | L3         | 2          |
| cs-servers-prism           |                                                              |                                                              | cs-gateway-statistics                                        | L3         | 3          |
| cs-servers-squirtgun       |                                                              |                                                              | ### 微服务                                                   |            |            |
| cs-servers-stapler         |                                                              |                                                              | 服务名称                                                     | 等级       | 实例数量   |
| cs-gateway-worksheetgate   | 待操作                                                       |                                                              | cs-microservice-dpu                                          | L3         | 3          |
| cs-kama-rtc                |                                                              |                                                              | cs-microservice-inspector                                    | L3         | 4          |
| cs-kama-pstn               |                                                              |                                                              | cs-microservice-postoffice                                   | L3         | 2          |